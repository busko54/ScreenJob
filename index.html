<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>CareerMove - Job Decision Analyzer</title>
 <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MWGBVLDZTW"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-MWGBVLDZTW');
</script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

 <!-- ***** STRIPE ***** -->
 <script src="https://js.stripe.com/v3/"></script>

 <style>
 * { margin: 0; padding: 0; box-sizing: border-box; }
 body { font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background: #0f0f1e; color: #e0e0e0; line-height: 1.6; }

 .landing { min-height: 100vh; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); display: flex; align-items: center; justify-content: center; padding: 40px 20px; text-align: center; position: relative; overflow: hidden; }
 .landing::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 20% 50%, rgba(233, 69, 96, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(76, 175, 255, 0.1) 0%, transparent 50%); pointer-events: none; }
 .landing-content { max-width: 900px; color: #fff; position: relative; z-index: 1; }
 .landing h1 { font-size: 72px; margin-bottom: 20px; font-weight: 900; background: linear-gradient(135deg, #4cb5ff 0%, #00d4ff 50%, #64ff9f 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -2px; }
 .landing .tagline { font-size: 28px; margin-bottom: 15px; font-weight: 700; color: #e0e0e0; }
 .landing .subtitle { font-size: 18px; margin-bottom: 40px; color: #b0b0b0; line-height: 1.8; }
 .cta-button { display: inline-block; padding: 16px 48px; background: linear-gradient(135deg, #00d4ff 0%, #4cb5ff 100%); color: #0f0f1e; font-size: 18px; font-weight: 700; border: none; border-radius: 12px; cursor: pointer; transition: all 0.3s; box-shadow: 0 10px 30px rgba(76, 181, 255, 0.3); }
 .cta-button:hover { transform: translateY(-3px); box-shadow: 0 15px 50px rgba(76, 181, 255, 0.5); }

 .social-proof { margin-top: 50px; padding: 25px; background: rgba(76, 181, 255, 0.08); border-radius: 12px; border: 1px solid rgba(76, 181, 255, 0.2); }
 .social-proof p { margin: 10px 0; font-size: 15px; color: #c0c0c0; }

 .how-it-works { margin-top: 100px; padding-top: 80px; border-top: 1px solid rgba(76, 181, 255, 0.2); }
 .how-it-works h2 { font-size: 42px; margin-bottom: 50px; font-weight: 800; background: linear-gradient(135deg, #00d4ff 0%, #64ff9f 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
 .steps { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; }
 .step { background: linear-gradient(135deg, rgba(76, 181, 255, 0.05) 0%, rgba(100, 255, 159, 0.05) 100%); padding: 35px; border-radius: 16px; text-align: left; border: 1px solid rgba(76, 181, 255, 0.2); transition: all 0.3s; }
 .step:hover { transform: translateY(-5px); border-color: rgba(76, 181, 255, 0.4); background: linear-gradient(135deg, rgba(76, 181, 255, 0.1) 0%, rgba(100, 255, 159, 0.1) 100%); }
 .step-number { display: inline-flex; width: 50px; height: 50px; background: linear-gradient(135deg, #00d4ff 0%, #4cb5ff 100%); color: #0f0f1e; font-weight: 800; border-radius: 50%; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 22px; }
 .step h3 { font-size: 22px; margin-bottom: 12px; font-weight: 700; color: #00d4ff; }
 .step p { color: #a0a0a0; }

 .pain-points { margin-top: 100px; padding: 50px 40px; background: linear-gradient(135deg, rgba(233, 69, 96, 0.08) 0%, rgba(255, 107, 107, 0.08) 100%); border-radius: 16px; text-align: left; border: 1px solid rgba(233, 69, 96, 0.2); }
 .pain-points h2 { font-size: 36px; margin-bottom: 30px; color: #ff6b6b; font-weight: 800; }
 .pain-points p { margin-bottom: 20px; color: #c0c0c0; }

 .final-cta { margin-top: 100px; padding: 60px 40px; background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(100, 255, 159, 0.1) 100%); border-radius: 16px; text-align: center; border: 2px solid rgba(76, 181, 255, 0.3); }
 .final-cta h2 { font-size: 40px; margin-bottom: 15px; background: linear-gradient(135deg, #00d4ff 0%, #64ff9f 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 800; }
 .final-cta p { color: #b0b0b0; margin-bottom: 30px; }

 .app-container { display: none; min-height: 100vh; background: #0f0f1e; padding: 20px; }
 .app-container.show { display: block; }
 .app-content { max-width: 900px; margin: 0 auto; background: #1a1a2e; border-radius: 16px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); padding: 40px; border: 1px solid rgba(76, 181, 255, 0.2); }
 .app-header { display: flex; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid rgba(76, 181, 255, 0.2); }
 .back-button { background: none; border: none; font-size: 28px; cursor: pointer; margin-right: 15px; color: #00d4ff; padding: 0; transition: 0.3s; }
 .back-button:hover { transform: scale(1.1); }
 .app-header h1 { font-size: 28px; margin: 0; background: linear-gradient(135deg, #00d4ff 0%, #64ff9f 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }

 h1 { font-size: 32px; color: #e0e0e0; margin-bottom: 8px; }
 .subtitle { color: #a0a0a0; margin-bottom: 30px; font-size: 14px; }
 .section { margin-bottom: 30px; }
 .section h2 { font-size: 18px; color: #00d4ff; margin-bottom: 15px; font-weight: 700; }
 .form-group { margin-bottom: 15px; }
 label { display: block; font-size: 14px; font-weight: 600; color: #c0c0c0; margin-bottom: 8px; }
 input, select, textarea { width: 100%; padding: 12px; border: 1px solid rgba(76, 181, 255, 0.3); background: rgba(76, 181, 255, 0.05); border-radius: 8px; font-size: 14px; font-family: inherit; color: #e0e0e0; transition: all 0.3s; }
 input::placeholder, textarea::placeholder { color: #606070; }
 input:focus, select:focus, textarea:focus { outline: none; border-color: #00d4ff; background: rgba(76, 181, 255, 0.1); box-shadow: 0 0 0 3px rgba(76, 181, 255, 0.15); }

 .slider-container { display: flex; align-items: center; gap: 15px; }
 input[type="range"] { flex: 1; cursor: pointer; accent-color: #00d4ff; }
 .slider-value { min-width: 40px; text-align: center; font-weight: 700; color: #64ff9f; background: rgba(100, 255, 159, 0.1); padding: 4px 8px; border-radius: 6px; }

 .button-row { display: flex; gap: 10px; margin-top: 30px; flex-wrap: wrap; }
 button { flex: 1; min-width: 150px; padding: 13px 24px; font-size: 16px; font-weight: 700; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-family: inherit; }
 .btn-primary { background: linear-gradient(135deg, #00d4ff 0%, #4cb5ff 100%); color: #0f0f1e; }
 .btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(76, 181, 255, 0.3); }
 .btn-secondary { background: rgba(76, 181, 255, 0.1); color: #00d4ff; border: 1px solid rgba(76, 181, 255, 0.3); }
 .btn-secondary:hover:not(:disabled) { background: rgba(76, 181, 255, 0.2); }
 button:disabled { opacity: 0.6; cursor: not-allowed; }

 .resume-status { background: rgba(100, 255, 159, 0.1); padding: 12px; border-radius: 8px; border: 1px solid rgba(100, 255, 159, 0.3); margin-bottom: 15px; font-size: 13px; color: #64ff9f; }
 .resume-status.empty { background: rgba(255, 107, 107, 0.1); border-color: rgba(255, 107, 107, 0.3); color: #ff6b6b; }

 .file-input-label { display: block; padding: 20px; border: 2px dashed rgba(76, 181, 255, 0.3); border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.3s; background: rgba(76, 181, 255, 0.05); }
 .file-input-label:hover { border-color: rgba(76, 181, 255, 0.6); background: rgba(76, 181, 255, 0.1); }
 .file-input-label input[type="file"] { display: none; }

 .recommendation { font-size: 48px; font-weight: 800; margin: 20px 0; padding: 25px; border-radius: 12px; text-align: center; }
 .recommendation.take { background: linear-gradient(135deg, rgba(100, 255, 159, 0.15) 0%, rgba(100, 255, 159, 0.05) 100%); color: #64ff9f; border: 1px solid rgba(100, 255, 159, 0.3); }
 .recommendation.pass { background: linear-gradient(135deg, rgba(255, 107, 107, 0.15) 0%, rgba(255, 107, 107, 0.05) 100%); color: #ff6b6b; border: 1px solid rgba(255, 107, 107, 0.3); }
 .recommendation.negotiate { background: linear-gradient(135deg, rgba(255, 179, 71, 0.15) 0%, rgba(255, 179, 71, 0.05) 100%); color: #ffb347; border: 1px solid rgba(255, 179, 71, 0.3); }

 .score { font-size: 24px; font-weight: 700; color: #00d4ff; margin: 15px 0; text-align: center; }
 .explanation { font-size: 16px; color: #a0a0a0; margin: 15px 0; line-height: 1.8; }

 .breakdown-item { background: rgba(76, 181, 255, 0.05); padding: 15px; margin-bottom: 12px; border-left: 4px solid #00d4ff; border-radius: 6px; }
 .breakdown-key { font-weight: 700; color: #64ff9f; text-transform: capitalize; }
 .breakdown-value { color: #b0b0b0; margin-top: 5px; font-size: 14px; }

 .ai-insight { background: linear-gradient(135deg, rgba(76, 181, 255, 0.1) 0%, rgba(76, 181, 255, 0.05) 100%); padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #4cb5ff; border: 1px solid rgba(76, 181, 255, 0.3); }
 .ai-insight h3 { font-size: 15px; font-weight: 700; margin-bottom: 12px; color: #00d4ff; }
 .ai-insight p { font-size: 14px; color: #b0b0b0; margin: 8px 0; line-height: 1.6; }

 .salary-data { background: linear-gradient(135deg, rgba(76, 181, 255, 0.1) 0%, rgba(76, 181, 255, 0.05) 100%); padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #4cb5ff; border: 1px solid rgba(76, 181, 255, 0.3); }
 .salary-data h3 { font-size: 15px; font-weight: 700; margin-bottom: 12px; color: #00d4ff; }
 .salary-data p { font-size: 14px; color: #b0b0b0; margin: 6px 0; }

 .email-capture { background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(100, 255, 159, 0.1) 100%); padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid rgba(76, 181, 255, 0.3); }
 .email-capture p { color: #a0a0a0; margin-bottom: 12px; font-size: 14px; }
 .email-input-row { display: flex; gap: 10px; margin-bottom: 10px; }
 .email-input-row input { flex: 1; }
 .email-input-row button { flex: 0.3; min-width: 80px; }
 .email-status { font-size: 12px; margin-top: 8px; color: #64ff9f; }
 .email-status.error { color: #ff6b6b; }

 .history-item { background: linear-gradient(135deg, rgba(76, 181, 255, 0.05) 0%, rgba(100, 255, 159, 0.05) 100%); padding: 18px; margin-bottom: 12px; border-left: 4px solid #4cb5ff; border-radius: 6px; border: 1px solid rgba(76, 181, 255, 0.2); }
 .history-rec { font-weight: 700; font-size: 16px; color: #00d4ff; }
 .history-date { font-size: 12px; color: #707080; margin-top: 8px; }

 .pros-cons { background: rgba(76, 181, 255, 0.05); padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid rgba(76, 181, 255, 0.2); }
 .pros-cons h3 { color: #64ff9f; margin-bottom: 10px; font-size: 16px; }
 .pro-item { color: #64ff9f; margin: 8px 0; padding-left: 20px; }
 .pro-item::before { content: 'Checkmark '; font-weight: bold; }
 .con-item { color: #ff6b6b; margin: 8px 0; padding-left: 20px; }
 .con-item::before { content: 'Cross '; font-weight: bold; }

 .comparison { background: rgba(76, 181, 255, 0.05); padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid rgba(76, 181, 255, 0.2); }
 .comparison-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 12px; align-items: center; }
 .comparison-label { color: #a0a0a0; font-weight: 600; }
 .comparison-current { color: #c0c0c0; }
 .comparison-new { color: #00d4ff; font-weight: 700; }

 .hidden { display: none; }

 /* ***** NEW: FEEDBACK MODAL ***** */
 #feedbackModal {
   position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
   background: #1a1a2e; padding: 20px; border-radius: 12px;
   border: 1px solid #00d4ff; z-index: 1000; width: 90%; max-width: 420px;
   display: none;
 }
 #feedbackModal h3 { color: #00d4ff; margin-bottom: 10px; }
 #feedbackModal select, #feedbackModal textarea { width: 100%; margin: 8px 0; }

 /* ***** NEW: EMAIL SIGNUP (landing) ***** */
 .signup-box {
   background: rgba(76,181,255,0.08); padding: 20px; border-radius: 12px;
   border: 1px solid rgba(76,181,255,0.2); margin-top: 40px;
 }
 .signup-box input { margin-bottom: 10px; }

 /* ***** NEW: UPGRADE PROMPT ***** */
 #upgradePrompt {
   background: rgba(100,255,159,0.1); padding: 20px; border-radius: 12px;
   margin: 20px 0; border: 1px solid rgba(100,255,159,0.3); display: none;
 }

 @media (max-width: 768px) {
   .landing h1 { font-size: 48px; }
   .landing .tagline { font-size: 22px; }
   .steps { grid-template-columns: 1fr; }
   .app-content { padding: 25px; max-width: 100%; }
   .comparison-row { grid-template-columns: 1fr; }
   button { min-width: 120px; }
 }
 </style>
</head>
<body>

 <!-- LANDING PAGE -->
 <div id="landingPage" class="landing">
   <div class="landing-content">
     <h1>CareerMove</h1>
     <p class="tagline">Stop making job decisions emotionally.</p>
     <p class="subtitle">AI-powered analysis based on YOUR background, priorities & market data. <strong>Free. No credit card.</strong></p>
     <button class="cta-button" onclick="startApp()">Analyze My Next Offer</button>

     <div class="social-proof">
       <p><strong>4.9/5</strong> from early users</p>
       <p>"AI actually understood my career trajectory and gave real negotiation advice" - Test User</p>
     </div>

     <div class="how-it-works">
       <h2>How It Works</h2>
       <div class="steps">
         <div class="step">
           <div class="step-number">1</div>
           <h3>Your Background</h3>
           <p>Upload your resume or tell us your background. AI learns your career arc.</p>
         </div>
         <div class="step">
           <div class="step-number">2</div>
           <h3>Enter Job Offer</h3>
           <p>Paste job posting or enter details. AI extracts everything.</p>
         </div>
         <div class="step">
           <div class="step-number">3</div>
           <h3>Get AI Analysis</h3>
           <p>Detailed recommendation + negotiation strategies + career alignment.</p>
         </div>
       </div>
     </div>

     <div class="pain-points">
       <h2>Why People Make Bad Job Decisions</h2>
       <p><strong>No Context:</strong> You don't compare to your career growth trajectory.</p>
       <p><strong>No Strategy:</strong> You accept offers without negotiating weak points.</p>
       <p><strong>No Data:</strong> You guess at market rates instead of knowing real data.</p>
     </div>

     <!-- ***** NEW: EMAIL SIGNUP ON LANDING ***** -->
     <div class="signup-box">
       <h3 style="color:#00d4ff; margin-bottom:12px;">Get updates & new features</h3>
       <input type="email" id="landingEmail" placeholder="you@example.com" style="width:100%;padding:10px;border-radius:6px;">
       <button class="btn-primary" onclick="signupLanding()" style="margin-top:8px;width:100%;">Join Waitlist</button>
       <p id="landingStatus" style="margin-top:8px;font-size:13px;"></p>
     </div>

     <div class="final-cta">
       <h2>Make smarter career moves</h2>
       <p>AI analyzes your full background in 2 minutes. Let's go.</p>
       <button class="cta-button" onclick="startApp()" style="padding: 18px 56px; font-size: 18px;">Start Now - Free</button>
     </div>

     <footer style="margin-top: 80px; padding-top: 30px; border-top: 1px solid rgba(76, 181, 255, 0.2); text-align: center;">
       <p style="color: #707080; font-size: 14px; margin-bottom: 15px;">
         <a href="privacy.html" style="color: #00d4ff; text-decoration: none; margin: 0 15px; transition: 0.3s;" onmouseover="this.style.color='#64ff9f'" onmouseout="this.style.color='#00d4ff'">Privacy Policy</a>
         <span style="color: #707080;">|</span>
         <a href="terms.html" style="color: #00d4ff; text-decoration: none; margin: 0 15px; transition: 0.3s;" onmouseover="this.style.color='#64ff9f'" onmouseout="this.style.color='#00d4ff'">Terms of Service</a>
         <span style="color: #707080;">|</span>
         <a href="mailto:support@careermove.app" style="color: #00d4ff; text-decoration: none; margin: 0 15px; transition: 0.3s;" onmouseover="this.style.color='#64ff9f'" onmouseout="this.style.color='#00d4ff'">Contact</a>
       </p>
       <p style="color: #606070; font-size: 13px;">&copy; 2024 CareerMove. All rights reserved.</p>
     </footer>
   </div>
 </div>

 <!-- APP -->
 <div id="appContainer" class="app-container">
   <div class="app-content">

     <!-- ***** NEW: FEEDBACK MODAL ***** -->
     <div id="feedbackModal">
       <h3>Quick feedback?</h3>
       <p>Was this helpful? (1-5)</p>
       <select id="feedbackScore"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
       <textarea id="feedbackText" placeholder="What to improve?" rows="3" style="width:100%;margin:10px 0;"></textarea>
       <button class="btn-primary" onclick="submitFeedback()" style="width:100%;">Send (optional)</button>
     </div>

     <!-- ***** NEW: UPGRADE PROMPT (shown after 1st eval) ***** -->
     <div id="upgradePrompt">
       <h3>Want unlimited evals + negotiation scripts?</h3>
       <p>$4.99/mo (cancel anytime) – one good decision pays for a year.</p>
       <button class="btn-primary" onclick="upgradeToPro()" style="width:100%;">Upgrade to Pro</button>
     </div>

     <!-- PROFILE SCREEN -->
     <div id="profileScreen">
       <h1>Your Background</h1>
       <p class="subtitle">Upload your resume or tell us about your career</p>

       <div class="section">
         <h2>Resume (Optional but Recommended)</h2>
         <div id="resumeStatus" class="resume-status empty">No resume uploaded yet</div>
         <label class="file-input-label">
           Upload Resume (PDF or TXT)
           <input type="file" id="resumeFile" accept=".pdf,.txt" onchange="handleResumeUpload(event)">
         </label>
         <button class="btn-secondary" id="extractResumeBtn" onclick="extractResumeData()" style="width: 100%; margin-top: 10px; display: none;">Extract from Resume</button>
       </div>

       <div class="section">
         <h2>Current Role</h2>
         <div class="form-group"><label>Current Job Title</label><input type="text" id="currentJobTitle" placeholder="e.g., Senior Software Engineer"></div>
         <div class="form-group"><label>Current Salary ($)</label><input type="number" id="currentSalary" value="80000"></div>
         <div class="form-group"><label>Current Hours Per Week</label><input type="number" id="currentHours" value="40"></div>
         <div class="form-group"><label>Years of Experience</label><input type="number" id="yearsExp" value="5" min="0"></div>
         <div class="form-group"><label>Current Company Size</label>
           <select id="currentCompanySize">
             <option value="startup">Startup (1-50)</option>
             <option value="small">Small (50-500)</option>
             <option value="mid" selected>Mid (500-5000)</option>
             <option value="large">Large (5000+)</option>
           </select>
         </div>
       </div>

       <div class="section">
         <h2>What Matters Most? (1-5 scale)</h2>
         <div class="form-group"><label>Salary & Compensation</label><div class="slider-container"><input type="range" id="prioritySalary" min="1" max="5" value="3"><span class="slider-value" id="salaryValue">3</span></div></div>
         <div class="form-group"><label>Work-Life Balance</label><div class="slider-container"><input type="range" id="priorityBalance" min="1" max="5" value="4"><span class="slider-value" id="balanceValue">4</span></div></div>
         <div class="form-group"><label>Career Growth & Learning</label><div class="slider-container"><input type="range" id="priorityGrowth" min="1" max="5" value="3"><span class="slider-value" id="growthValue">3</span></div></div>
         <div class="form-group"><label>Job Stability & Security</label><div class="slider-container"><input type="range" id="priorityStability" min="1" max="5" value="4"><span class="slider-value" id="stabilityValue">4</span></div></div>
         <div class="form-group"><label>Remote Work Flexibility</label><div class="slider-container"><input type="range" id="priorityRemote" min="1" max="5" value="3"><span class="slider-value" id="remoteValue">3</span></div></div>
         <div class="form-group"><label>Brand & Company Prestige</label><div class="slider-container"><input type="range" id="priorityBrand" min="1" max="5" value="2"><span class="slider-value" id="brandValue">2</span></div></div>
       </div>

       <div class="button-row">
         <button class="btn-primary" onclick="goToJobScreen()">Next: Enter Job Offer</button>
         <button class="btn-secondary" onclick="showHistory()">View History</button>
       </div>
     </div>

     <!-- JOB SCREEN -->
     <div id="jobScreen" class="hidden">
       <div class="app-header">
         <button class="back-button" onclick="goToProfileScreen()">Back</button>
         <h1>Job Offer Details</h1>
       </div>

       <div class="section" style="background: rgba(100, 255, 159, 0.05); padding: 15px; border-radius: 8px; border: 1px solid rgba(100, 255, 159, 0.2); margin-bottom: 20px;">
         <p style="color: #64ff9f; font-size: 13px; margin-bottom: 10px;"><strong>Quick Fill:</strong> Paste a job posting and AI will extract everything</p>
         <div class="form-group"><textarea id="jobPostingPaste" placeholder="Paste the full job posting here (LinkedIn, Indeed, email offer, etc.)" style="height: 120px; resize: vertical;"></textarea></div>
         <button class="btn-secondary" onclick="extractJobData()" style="width: 100%;">Auto-Fill from Posting</button>
       </div>

       <div style="text-align: center; color: #707080; margin: 20px 0; font-size: 13px;">— OR ENTER MANUALLY —</div>

       <div class="section">
         <div class="form-group"><label>Job Title</label><input type="text" id="jobTitle" placeholder="e.g., Senior Software Engineer"></div>
         <div class="form-group"><label>Company Name</label><input type="text" id="company" placeholder="e.g., Google"></div>
         <div class="form-group"><label>Base Salary ($)</label><input type="number" id="baseSalary" placeholder="e.g., 150000"></div>
         <div class="form-group"><label>Equity/Stock Options (% or value)</label><input type="text" id="equity" placeholder="e.g., 0.5% or $50k"></div>
         <div class="form-group"><label>Bonus (% or $)</label><input type="text" id="bonus" placeholder="e.g., 20% or $20k"></div>
         <div class="form-group"><label>Hours Per Week</label><input type="number" id="hoursPerWeek" value="45"></div>
         <div class="form-group"><label>Company Stage</label>
           <select id="fundingStage">
             <option value="seed">Seed Startup (Very High Risk)</option>
             <option value="series-a">Series A (High Risk)</option>
             <option value="series-b">Series B-C (Moderate Risk)</option>
             <option value="growth" selected>Growth Stage (Stable)</option>
             <option value="public">Public Company (Very Safe)</option>
           </select>
         </div>
         <div class="form-group"><label>Team Size</label><input type="number" id="teamSize" value="5" min="1"></div>
         <div class="form-group"><label>Work Environment</label>
           <select id="workEnv">
             <option value="full-remote">Fully Remote</option>
             <option value="hybrid">Hybrid</option>
             <option value="onsite" selected>On-site</option>
           </select>
         </div>
         <div class="form-group"><label>Company Industry/Domain</label><input type="text" id="industry" placeholder="e.g., AI/ML, FinTech, Healthcare"></div>
         <div class="form-group"><label>Any concerns or notes?</label><textarea id="concerns" placeholder="e.g., Long commute, unclear growth path, company culture concerns..."></textarea></div>
       </div>

       <div class="button-row">
         <button class="btn-primary" id="analyzeBtn" onclick="analyzeOffer()">Analyze This Offer</button>
       </div>
     </div>

     <!-- RESULT SCREEN -->
     <div id="resultScreen" class="hidden">
       <div class="app-header">
         <button class="back-button" onclick="goToJobScreen()">Back</button>
         <h1>Analysis</h1>
       </div>

       <div id="resultContent"></div>

       <!-- ***** NEW: EMAIL SIGNUP ON RESULT ***** -->
       <div class="signup-box" style="margin-top:30px;">
         <h3 style="color:#00d4ff; margin-bottom:12px;">Never lose this analysis</h3>
         <input type="email" id="resultEmailSignup" placeholder="you@example.com" style="width:100%;padding:10px;border-radius:6px;">
         <button class="btn-primary" onclick="signupResult()" style="margin-top:8px;width:100%;">Save to Email List</button>
         <p id="resultSignupStatus" style="margin-top:8px;font-size:13px;"></p>
       </div>

       <div class="email-capture">
         <p><strong>Save This Analysis</strong></p>
         <div class="email-input-row">
           <input type="email" id="resultEmail" placeholder="your@email.com">
           <button class="btn-secondary" onclick="saveAnalysisToEmail()">Email</button>
           <button class="btn-secondary" onclick="exportToPDF()">PDF</button>
         </div>
         <div id="emailStatus" class="email-status"></div>
       </div>

       <div class="button-row">
         <button class="btn-primary" onclick="goToJobScreen()">Analyze Another</button>
         <button class="btn-secondary" onclick="goToProfileScreen()">Update Profile</button>
       </div>
     </div>

     <!-- HISTORY SCREEN -->
     <div id="historyScreen" class="hidden">
       <div class="app-header">
         <button class="back-button" onclick="goToProfileScreen()">Back</button>
         <h1>Your Decisions</h1>
       </div>
       <div id="historyContent"></div>
       <div class="button-row">
         <button class="btn-secondary" onclick="goToProfileScreen()">Back</button>
       </div>
     </div>

   </div>
 </div>

 <script>
 pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

 // ---------- GLOBAL STATE ----------
 let resumeData = null;
 let decisions = JSON.parse(localStorage.getItem('careerDecisions') || '[]');
 let lastAnalysis = null;
 let evalCount = parseInt(localStorage.getItem('evalCount') || '0');

 // ---------- SLIDER DISPLAY ----------
 ['prioritySalary','priorityBalance','priorityGrowth','priorityStability','priorityRemote','priorityBrand'].forEach(id => {
   document.getElementById(id).addEventListener('input', e => {
     const name = id.replace('priority','').toLowerCase();
     document.getElementById(name + 'Value').textContent = e.target.value;
   });
 });

 // ---------- NAV ----------
 function startApp() {
   document.getElementById('landingPage').style.display = 'none';
   document.getElementById('appContainer').classList.add('show');
   showScreen('profileScreen');
 }
 function showScreen(id) {
   document.querySelectorAll('[id$="Screen"]').forEach(el => el.classList.add('hidden'));
   document.getElementById(id).classList.remove('hidden');
 }
 function goToProfileScreen(){ showScreen('profileScreen'); }
 function goToJobScreen(){ showScreen('jobScreen'); }

 // ---------- RESUME ----------
 async function handleResumeUpload(event) {
   const file = event.target.files[0];
   if (!file) return;
   const statusEl = document.getElementById('resumeStatus');
   const extractBtn = document.getElementById('extractResumeBtn');
   statusEl.textContent = 'Reading resume...';
   statusEl.classList.remove('empty');
   try {
     let text = '';
     if (file.type === 'application/pdf') text = await extractTextFromPDF(file);
     else if (file.type === 'text/plain') text = await file.text();
     else throw new Error('Unsupported');
     resumeData = { text, fileName: file.name };
     statusEl.innerHTML = `Resume loaded: <strong>${file.name}</strong>`;
     extractBtn.style.display = 'block';
   } catch (e) {
     statusEl.textContent = 'Error reading file.';
     statusEl.classList.add('empty');
     extractBtn.style.display = 'none';
   }
 }
 async function extractTextFromPDF(file) {
   const arrayBuffer = await file.arrayBuffer();
   const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
   let text = '';
   for (let i = 1; i <= pdf.numPages; i++) {
     const page = await pdf.getPage(i);
     const content = await page.getTextContent();
     text += content.items.map(item => item.str).join(' ') + '\n';
   }
   return text;
 }
 async function extractResumeData() {
   if (!resumeData) return;
   const btn = document.getElementById('extractResumeBtn');
   btn.textContent = 'Extracting...'; btn.disabled = true;
   try {
     const response = await fetch("/api/extract-resume", {
       method: "POST",
       headers: { "Content-Type": "application/json" },
       body: JSON.stringify({ resumeText: resumeData.text })
     });
     if (!response.ok) throw new Error('API error');
     const data = await response.json();
     if (data.currentJobTitle) document.getElementById('currentJobTitle').value = data.currentJobTitle;
     if (data.yearsOfExperience) document.getElementById('yearsExp').value = data.yearsOfExperience;
     btn.textContent = 'Extracted!';
     setTimeout(() => { btn.textContent = 'Extract from Resume'; btn.disabled = false; }, 2000);
   } catch (e) {
     btn.textContent = 'Failed';
     setTimeout(() => { btn.textContent = 'Extract from Resume'; btn.disabled = false; }, 2000);
   }
 }

 // ---------- JOB ----------
 async function extractJobData() {
   const posting = document.getElementById('jobPostingPaste').value.trim();
   if (!posting) { alert('Paste a job posting first'); return; }
   const btn = event.target;
   btn.textContent = 'Extracting...'; btn.disabled = true;
   try {
     const response = await fetch("/api/extract-job", {
       method: "POST",
       headers: { "Content-Type": "application/json" },
       body: JSON.stringify({ jobPosting: posting })
     });
     if (!response.ok) throw new Error('API error');
     const data = await response.json();
     ['jobTitle','company','baseSalary','equity','bonus','hoursPerWeek','workEnv','fundingStage','teamSize','industry'].forEach(f => {
       if (data[f]) document.getElementById(f).value = data[f];
     });
     btn.textContent = 'Filled!';
     setTimeout(() => { btn.textContent = 'Auto-Fill from Posting'; btn.disabled = false; }, 2000);
   } catch (e) {
     alert('Extraction failed – fill manually.');
     btn.textContent = 'Auto-Fill from Posting'; btn.disabled = false;
   }
 }

 // ---------- ANALYSIS ----------
 async function analyzeOffer() {
   const required = ['baseSalary','jobTitle','company'];
   if (required.some(id => !document.getElementById(id).value)) {
     alert('Fill job title, company & salary');
     return;
   }
   const btn = document.getElementById('analyzeBtn');
   btn.textContent = 'AI Analyzing...'; btn.disabled = true;

   const profile = {
     currentJobTitle: document.getElementById('currentJobTitle').value,
     currentSalary: parseInt(document.getElementById('currentSalary').value),
     currentHours: parseInt(document.getElementById('currentHours').value),
     yearsExp: parseInt(document.getElementById('yearsExp').value),
     currentCompanySize: document.getElementById('currentCompanySize').value,
     priority_salary: parseInt(document.getElementById('prioritySalary').value),
     priority_balance: parseInt(document.getElementById('priorityBalance').value),
     priority_growth: parseInt(document.getElementById('priorityGrowth').value),
     priority_stability: parseInt(document.getElementById('priorityStability').value),
     priority_remote: parseInt(document.getElementById('priorityRemote').value),
     priority_brand: parseInt(document.getElementById('priorityBrand').value),
     resumeData: resumeData ? resumeData.text.substring(0,2000) : null
   };
   const job = {
     jobTitle: document.getElementById('jobTitle').value,
     company: document.getElementById('company').value,
     baseSalary: parseInt(document.getElementById('baseSalary').value),
     equity: document.getElementById('equity').value,
     bonus: document.getElementById('bonus').value,
     hoursPerWeek: parseInt(document.getElementById('hoursPerWeek').value),
     workEnv: document.getElementById('workEnv').value,
     fundingStage: document.getElementById('fundingStage').value,
     teamSize: parseInt(document.getElementById('teamSize').value),
     industry: document.getElementById('industry').value,
     concerns: document.getElementById('concerns').value
   };

   try {
     const response = await fetch("/api/analyze-offer", {
       method: "POST",
       headers: { "Content-Type": "application/json" },
       body: JSON.stringify({ profile, job })
     });
     if (!response.ok) throw new Error('API error');
     const ai = await response.json();
     const salary = getSalaryData(job.jobTitle);

     // ---- SAVE & COUNT ----
     evalCount++; localStorage.setItem('evalCount', evalCount);
     decisions.push({ ...ai, job, profile, salary, timestamp: new Date().toLocaleString() });
     localStorage.setItem('careerDecisions', JSON.stringify(decisions));

     displayResult(ai, salary, job, profile);
     showScreen('resultScreen');

     // ---- SHOW UPGRADE AFTER FIRST FREE EVAL ----
     if (evalCount >= 1) document.getElementById('upgradePrompt').style.display = 'block';

     // ---- SHOW FEEDBACK MODAL ----
     setTimeout(() => document.getElementById('feedbackModal').style.display = 'block', 5000);
   } catch (e) {
     alert('Analysis failed – try again.');
   } finally {
     btn.textContent = 'Analyze This Offer'; btn.disabled = false;
   }
 }

 function getSalaryData(title) {
   const ranges = {
     'engineer': { low: 90000, high: 250000, median: 160000 },
     'manager': { low: 110000, high: 280000, median: 180000 },
     'designer': { low: 80000, high: 180000, median: 130000 },
     'product': { low: 100000, high: 250000, median: 170000 },
     'developer': { low: 85000, high: 220000, median: 150000 },
     'analyst': { low: 70000, high: 180000, median: 120000 },
     'architect': { low: 120000, high: 300000, median: 200000 },
     'default': { low: 60000, high: 180000, median: 110000 }
   };
   const key = Object.keys(ranges).find(k => title.toLowerCase().includes(k)) || 'default';
   return ranges[key];
 }

 function displayResult(analysis, salaryData, job, profile) {
   lastAnalysis = { analysis, salaryData, job, profile };
   const recClass = analysis.recommendation === 'TAKE' ? 'take' :
                    analysis.recommendation === 'PASS' ? 'pass' : 'negotiate';
   const salaryChange = job.baseSalary - profile.currentSalary;
   const salaryPct = ((salaryChange / profile.currentSalary) * 100).toFixed(1);
   const percentile = Math.round(((job.baseSalary - salaryData.low) / (salaryData.high - salaryData.low)) * 100);

   let html = `
     <div class="recommendation ${recClass}">${analysis.recommendation}</div>
     <div class="score">Alignment Score: ${analysis.score}/10 (${analysis.confidence}% confidence)</div>
     <div class="explanation">${analysis.reasoning}</div>

     <div class="ai-insight"><h3>Career Impact</h3><p>${analysis.careerImpact}</p></div>

     <div class="comparison">
       <h3 style="color:#00d4ff;margin-bottom:15px;">Offer vs Current</h3>
       <div class="comparison-row"><div class="comparison-label">Base Salary</div><div class="comparison-current">${profile.currentSalary.toLocaleString()}</div><div class="comparison-new">${job.baseSalary.toLocaleString()} (${salaryPct>0?'+':''}${salaryPct}%)</div></div>
       <div class="comparison-row"><div class="comparison-label">Hours/Week</div><div class="comparison-current">${profile.currentHours}h</div><div class="comparison-new">${job.hoursPerWeek}h (${job.hoursPerWeek-profile.currentHours>0?'+':''}${job.hoursPerWeek-profile.currentHours})</div></div>
       <div class="comparison-row"><div class="comparison-label">Hourly Rate</div><div class="comparison-current">${(profile.currentSalary/(profile.currentHours*52)).toFixed(0)}/hr</div><div class="comparison-new">${(job.baseSalary/(job.hoursPerWeek*52)).toFixed(0)}/hr</div></div>
     </div>

     <div class="salary-data"><h3>Market Data for ${job.jobTitle}</h3>
       <p><strong>Your offer:</strong> ${job.baseSalary.toLocaleString()}</p>
       <p><strong>Market range:</strong> ${salaryData.low.toLocaleString()} - ${salaryData.high.toLocaleString()}</p>
       <p><strong>Your position:</strong> ${percentile}th percentile (${percentile<30?'below':percentile<70?'at':'above'} market)</p>
       ${job.equity?`<p><strong>Equity:</strong> ${job.equity}</p>`:''}
       ${job.bonus?`<p><strong>Bonus:</strong> ${job.bonus}</p>`:''}
     </div>

     <div class="pros-cons"><h3 style="color:#64ff9f;">Strengths</h3>${analysis.strengths.map(s=>`<div class="pro-item">${s}</div>`).join('')}</div>
     <div class="pros-cons"><h3 style="color:#ff6b6b;">Weaknesses</h3>${analysis.weaknesses.map(w=>`<div class="con-item">${w}</div>`).join('')}</div>

     ${analysis.recommendation==='NEGOTIATE' && analysis.negotiableItems?`
       <div class="ai-insight"><h3>What to Negotiate</h3>${analysis.negotiableItems.map(p=>`<p style="margin:8px 0;">• ${p}</p>`).join('')}</div>`:''}

     <div class="ai-insight"><h3>Risk Factors</h3><p>${analysis.riskFactors}</p></div>

     <div class="section"><h2>Scoring Breakdown</h2>
       ${Object.entries(analysis.scoringBreakdown).map(([k,v])=>`<div class="breakdown-item"><div class="breakdown-key">${k}</div><div class="breakdown-value">${v}</div></div>`).join('')}
     </div>

     <div class="ai-insight"><h3>Questions to Ask Employer</h3>${analysis.questions.map(q=>`<p>• ${q}</p>`).join('')}</div>
   `;
   document.getElementById('resultContent').innerHTML = html;
 }

 // ---------- EMAIL / PDF ----------
 function saveAnalysisToEmail() {
   const email = document.getElementById('resultEmail').value.trim();
   const status = document.getElementById('emailStatus');
   if (!email || !email.includes('@')) { status.textContent='Invalid email'; status.classList.add('error'); return; }
   status.classList.remove('error'); status.textContent='Sending...';
   setTimeout(() => { status.textContent='Saved! (backend coming soon)'; setTimeout(()=>{status.textContent='';},4000); }, 800);
 }
 function exportToPDF() {
   if (!lastAnalysis) return;
   const {analysis,salaryData,job,profile} = lastAnalysis;
   const htmlContent = `<!DOCTYPE html><html><head><title>CareerMove - ${job.company}</title><style>/* (same PDF styles you already had) */</style></head><body>
     <h1>CareerMove - Job Offer Analysis</h1><p><strong>Generated:</strong> ${new Date().toLocaleString()}</p>
     <p><strong>Company:</strong> ${job.company} | <strong>Position:</strong> ${job.jobTitle}</p>
     <h2>Recommendation</h2><div class="recommendation ${analysis.recommendation.toLowerCase()}">${analysis.recommendation} - ${analysis.score}/10</div>
     /* ... rest of your PDF markup ... */
   </body></html>`;
   const script = document.createElement('script');
   script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js';
   script.onload = () => {
     const el = document.createElement('div'); el.innerHTML = htmlContent;
     html2pdf().set({margin:10,filename:`CareerMove-${job.company}-Analysis.pdf`,jsPDF:{unit:'mm',format:'a4'}}).from(el).save();
   };
   document.head.appendChild(script);
 }

 // ---------- HISTORY ----------
 function showHistory() {
   const container = document.getElementById('historyContent');
   if (!decisions.length) {
     container.innerHTML = '<p style="color:#a0a0a0;text-align:center;padding:30px;">No decisions yet.</p>';
   } else {
     container.innerHTML = decisions.map(d=>`
       <div class="history-item">
         <div class="history-rec">${d.recommendation} (${d.score}/10)</div>
         <div style="color:#c0c0c0;font-weight:500;">${d.job.jobTitle} @ ${d.job.company}</div>
         <div style="color:#909090;font-size:13px;">${d.job.baseSalary.toLocaleString()} • ${d.job.hoursPerWeek}h/week • ${d.job.fundingStage}</div>
         <div class="history-date">${d.timestamp}</div>
       </div>`).join('');
   }
   showScreen('historyScreen');
 }

 // ---------- NEW: EMAIL SIGNUP (landing & result) ----------
 async function signupLanding() {
   const email = document.getElementById('landingEmail').value.trim();
   const status = document.getElementById('landingStatus');
   if (!email || !email.includes('@')) { status.textContent='Invalid email'; return; }
   status.textContent='Sending...';
   // Replace YOUR_FORM_ID with a free Formspree.io endpoint
   await fetch('https://formspree.io/f/YOUR_FORM_ID', {
     method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({email})
   });
   status.textContent='Thanks! You’re on the list.';
   setTimeout(()=>{status.textContent='';},4000);
 }
 async function signupResult() {
   const email = document.getElementById('resultEmailSignup').value.trim();
   const status = document.getElementById('resultSignupStatus');
   if (!email || !email.includes('@')) { status.textContent='Invalid email'; return; }
   status.textContent='Sending...';
   await fetch('https://formspree.io/f/YOUR_FORM_ID', {
     method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({email})
   });
   status.textContent='Saved! You’ll get updates.';
   setTimeout(()=>{status.textContent='';},4000);
 }

 // ---------- NEW: FEEDBACK ----------
 function submitFeedback() {
   const score = document.getElementById('feedbackScore').value;
   const text = document.getElementById('feedbackText').value;
   // Send to Formspree (same endpoint) or just log
   fetch('https://formspree.io/f/YOUR_FORM_ID', {
     method:'POST',
     headers:{'Content-Type':'application/json'},
     body:JSON.stringify({score, feedback:text, page:'CareerMove'})
   }).then(()=>{ alert('Thanks!'); document.getElementById('feedbackModal').style.display='none'; });
 }

 // ---------- NEW: STRIPE ----------
 const stripe = Stripe('pk_test_YOUR_PUBLISHABLE_KEY'); // <-- replace with your test/live key
 function upgradeToPro() {
   // For a real product you need a tiny backend to create Checkout Session.
   // Here we just redirect to a test session (replace with your own).
   stripe.redirectToCheckout({
     lineItems: [{price: 'price_1YOURPRICEID', quantity: 1}],
     mode: 'subscription',
     successUrl: window.location.href + '?pro=1',
     cancelUrl: window.location.href
   });
 }
 // If user lands with ?pro=1 → unlock locally (demo only)
 if (window.location.search.includes('pro=1')) {
   localStorage.setItem('isPro','true');
   document.getElementById('upgradePrompt').style.display='none';
 }
 if (localStorage.getItem('isPro')==='true') {
   document.getElementById('upgradePrompt').style.display='none';
 }

 // Show upgrade prompt after first eval (already handled in analyzeOffer)
 </script>
</body>
</html>
